@model IEnumerable<MvcApplicationDatabase.Models.Tag>
@{
    ViewBag.Title = "Top tags";
}

    @Scripts.Render("~/Scripts/jquery-1.7.1.js")
    @Scripts.Render("~/Scripts/jquery-ui-1.8.20.js")
 
<h2>@ViewBag.Title</h2>


<script type="text/javascript">
    function restoreSummary(who) {
        //grab the summary element
        var node = document.getElementById(who) //this will find the modified textarea
        var parentNode = node.parentNode;

        var newNode = document.createElement("div");
        newNode.setAttribute("id", who);
        var newCont = document.createTextNode(node.innerHTML);
        newNode.appendChild(newCont);

        var modButtons = parentNode.getElementsByClassName('summary-button');

        parentNode.replaceChild(newNode, node);
        parentNode.removeChild(modButtons[0]);
        parentNode.removeChild(modButtons[0]);
    }
    function modSummary(who) {
        //grab the summary element
        var node = document.getElementById(who)
        var parentNode = node.parentNode;

        //create textarea and set initial summary text
        var newNode = document.createElement("TEXTAREA");
        newNode.setAttribute("id", who);
        newNode.setAttribute("rows", "3"); //doesn't seem to do anything
        newNode.setAttribute("style", "resize: none;");
        var newCont = document.createTextNode(node.innerHTML);
        newNode.appendChild(newCont);

        //insert buttons
        var setButton = document.createElement("a");
        setButton.setAttribute("href", "");
        setButton.setAttribute("class", "summary-button");
        var setButtonCont = document.createTextNode("Set");
        setButton.appendChild(setButtonCont);

        var cancelButton = document.createElement("a");
        cancelButton.setAttribute("href", "javascript:restoreSummary('" + who + "')");
        cancelButton.setAttribute("class", "summary-button");
        var cancelButtonCont = document.createTextNode("Cancel");
        cancelButton.appendChild(cancelButtonCont);

        //replace it
        parentNode.replaceChild(newNode, node);
        parentNode.appendChild(setButton);
        parentNode.appendChild(cancelButton);
    }
</script>


<div class="tag-list">
    @foreach (var t in Model)
    {
        <div class="tag-item">
            <a href="@Html.Raw("/question/tagged/" + Uri.EscapeDataString(t.Name.ToLower()))" class="post-tag">@t.Name</a>  
            <span class="tag-excerpt"> 
                #@t.Questions.Count
                <a href="javascript:modSummary('summary @t.Tag_id')">Edit</a>
                <br /> </span>
            <div class ="tag-excerpt" id="summary @t.Tag_id">
@t.Summary
            </div>
        </div>
        
    }

    <div class="clear"></div>

</div>
